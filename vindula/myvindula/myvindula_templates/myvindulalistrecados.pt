<html>
<body metal:use-macro="here/main_template/macros/master">
<metal:js fill-slot="javascript_head_slot">
	<script type="text/javascript" 
    tal:attributes="src string:${view/static}/ajax_comments-curtir.js"></script>
</metal:js>	

<metal:block fill-slot="top_slot">
        <tal:dummy tal:define="dummy python:request.set('disable_border',1)" />
</metal:block>

    <div metal:fill-slot="content" tal:define="member python:context.portal_membership.getAuthenticatedMember();
											   logado python:str(member)!='Anonymous User';
											   user python:member.getUserName() or None">
											   
		<metal:use use-macro="context/@@myvindulapanel/macros/page"/>
		

		<input type="hidden" id="portal_url" tal:attributes="value context/portal_url|nothing">
		<input type="hidden" id="context_url" tal:attributes="value string:${context/REQUEST/getURL|nothing}?user=${context/REQUEST/form/user|nothing}">
		<input type="hidden" id="username" name="username" value="" tal:attributes="value context/@@plone_portal_state/member|nothing">
		<div id="content">
			<div id="scraps" class="userpage geral_lista_comentarios">
				<h2 class="h2title">Recados que deixaram para você!</h2>
    			<tal:def define="items python:view.get_recados(user);">
					<div class="userpage geral_lista_comentarios" tal:condition="items">
						<tal:rep tal:repeat="item items">
							<div class="comment item_lista" tal:define="user item/username|nothing;
																		form_data python:view.get_prefs_user(user) or {};"> 
								<div class="commentImage">
				                    <img src="defaultUser.png" alt="" border="0" height="30"
					             		 tal:attributes="src python:view.getPhoto(user);
								 						 alt form_data/name|nothing;
														 title form_data/name|nothing;" />
				                </div>
								<div class="documentByLine name-user">
									<h4><a tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${user}">
											<span tal:replace="form_data/name|nothing" /> | 
					                    	<span tal:condition="item/date_creation|nothing" tal:replace="python:item.date_creation.strftime('%d/%m/%Y  %H:%M')" />
										</a></h4>
				                </div>
								<div id="like" tal:condition="logado">
									<div tal:attributes="id item/id|nothing">
										<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
										<input type="hidden" name="type" id="type" value="ModelsMyvindulaRecados" />
									</div>
									<div metal:use-macro="context/myvindula-like-macro/macros/like" />
								</div>
				                <div class="comment-body">
				                    <p tal:replace="item/text|nothing" />
						  		</div>
								<!-- campos input necessario para a criação de comentariso -->
								<div id="comments" tal:condition="logado" >
									<div tal:attributes="id item/id|nothing">
										<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
										<input type="hidden" name="type" id="type" value="ModelsMyvindulaRecados" />
									</div>
									<input type="button" value="Comentar" class="comments bt_comments" tal:attributes="id item/id|nothing" />
									<form action="#" method="post" enctype="multipart/form-data" style="float:right"
					                			  tal:attributes="action string:${context/absolute_url}/myvindulalistrecados">
											<input type="hidden" name="form.excluir:boolean" value="True" />
												
											<input type="hidden" name="id_recado" id="id_recado" tal:attributes="value item/id|nothing" />
											<input type="submit" name="excluir" id="excluir" value="Excluir" 
																	 class="comments bt_comments" tal:attributes="id item/id|nothing" />	
									</form>
									
									<div id="new-comments"></div>
								</div>
							</div>
							<div class="comments-cont">
								<div metal:use-macro="context/myvindula-comments-macro/macros/comments" />
							</div>
						</tal:rep>	
					</div>
				</tal:def>
			</div>
		</div>
    </div>    
</body>
</html>