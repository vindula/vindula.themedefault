<html>
<body metal:use-macro="here/main_template/macros/master">

<metal:js fill-slot="javascript_head_slot">
	<script type="text/javascript" 
    tal:attributes="src string:${view/static}/comments-perfil.js"></script>
	<script type="text/javascript" 
    tal:attributes="src string:${view/static}/ajax_comments-curtir.js"></script>
</metal:js>	
	
<metal:block fill-slot="top_slot">
        <tal:dummy tal:define="dummy python:request.set('disable_border',1)" />
</metal:block>

	    
    <div metal:fill-slot="content" tal:define="member python:context.portal_membership.getAuthenticatedMember();
											   logado python:str(member)!='Anonymous User';
											   configuracao view/get_campos; 
											   form_data view/load_list | python:{};
											   user form_data/username|nothing">
											   
    	<tal:cont tal:condition="form_data">
			<tal:cond tal:condition="python: str(member)==form_data.username">
	    		<input id="user-igual" type="hidden" value="True">
				<metal:use use-macro="context/@@myvindulapanel/macros/page"/>                
		    </tal:cond>
			
			<tal:cont tal:condition="python: str(member)!=form_data.username">
				<input id="user-igual"  type="hidden" value="False">
				<div id="edit-bar">
		            <h5 class="hiddenStructure">Visões</h5>
		
		            <ul id="content-views" class="contentViews">
		            	<li class="selected" id="howareu-menu">
		                    <a id="howareu-menu" style="cursor:pointer;" >Pensamentos</a>
		                </li>
						<li class="plain" id="scraps-menu">
		                    <a id="scraps-menu"  style="cursor:pointer;" >Recados</a>
		                </li>
						<li class="plain" id="perfil-menu">
		                    <a id="perfil-menu"  style="cursor:pointer;" >Perfil P&uacute;blico</a>
		                </li>
		            </ul><div class="contentActions">&nbsp;</div>
	        	</div>
			</tal:cont>	
    	</tal:cont>
		<input type="hidden" id="portal_url" tal:attributes="value context/portal_url|nothing">
		<input type="hidden" id="context_url" tal:attributes="value string:${context/REQUEST/getURL|nothing}?user=${context/REQUEST/form/user|nothing}">
		<input type="hidden" id="username" name="username" value="" tal:attributes="value context/@@plone_portal_state/member|nothing">
		<div id="content">
			<div id="interna" class="userpage ">
				 <h2 class="h2title">Informa&ccedil;&otilde;es do Perfil</h2>
				<div class="titulo">
					<h2 tal:content="form_data/name|nothing"></h2>
				</div>
				
				<div class="department">
					<tal:def define="departamentos python: view.get_department(user)">
		        		<tal:rep repeat="departamento departamentos">
		        			<span tal:content="departamento/Title|nothing">Departamento</span>
							<span tal:define="cont repeat/departamento/length;
												   last repeat/departamento/end"
								  tal:condition="python: cont > 1 and not last"> | </span>
		        		</tal:rep>
		        	</tal:def>
					<!--span tal:content="form_data/departamento/name|nothing"></span-->
				</div>
				
				<!-- start: Personal Information -->
				<div id="personal">
					<div id="photo">    
			            <img tal:define="photo form_data/username|nothing; img python:view.getPhoto(photo)" 
			                 tal:condition="img"
			                tal:attributes="src img">
					</div>
				
					<div id="data" tal:condition="view/valida_pessoal|nothing">
						<div class="area"><span>Pessoal</span></div>
							<table>
								<tr tal:condition="configuracao/employee_id|nothing">
									<td class="field">ID</td>
									<td class="value" tal:content="form_data/employee_id|nothing"></td>
								</tr>
								<tr tal:condition="configuracao/nickname|nothing">
									<td class="field">Apelido</td>
									<td class="value" tal:content="form_data/nickname|nothing"></td>
								</tr>
								<tr tal:condition="configuracao/pronunciation_name|nothing">
									<td class="field">Pron&uacute;ncia do nome</td>
									<td class="value" tal:content="form_data/pronunciation_name|nothing"></td>
								</tr>
								<tr tal:condition="configuracao/date_birth|nothing">
									<td class="field">Data de anivers&aacute;rio</td>
									<td class="value" tal:condition="form_data/date_birth|nothing"
													  tal:content="python: form_data.date_birth.strftime('%d/%m')"></td>
									<td class="value" tal:condition="not: form_data/date_birth|nothing"></td>												  
								</tr>
							</table>
						<a id="send-mail" tal:condition="configuracao/email|nothing" 
										  tal:attributes="href string:mailto:${form_data/email|nothing}">Enviar e-mail</a>
					</div>
				</div>
				<!-- end: Personal Information -->
			</div>

			<!-- Meus Pensamentos -->
			<div id="howareu" class="userpage geral_lista_comentarios">
				<h2 class="h2title" tal:content="string: No que ${form_data/name|nothing} est&aacute; pensando!"></h2>
				<tal:def define="items python: view.get_howareu(user)">
					<tal:rep tal:repeat="item items">
						<div class="comment item_lista">
							<div class="commentImage">
								<a tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${user}">
				                    <img src="defaultUser.png" border="0" height="30"
					             		 tal:attributes="src python:view.getPhoto(user);
								 						 alt form_data/name|nothing;
														 title form_data/name|nothing;" />
								</a>
			                </div>
							<div class="documentByLine name-user">
								<h4>
									<a tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${user}">
										<span tal:replace="form_data/name|nothing" /> | 
				                    	<span tal:condition="item/date_creation|nothing" 
											  tal:replace="python:item.date_creation.strftime('%d/%m/%Y  %H:%M')" />
										
									</a>
								</h4>
			                </div>
							<div id="like" tal:condition="logado">
								<div tal:attributes="id item/id|nothing">
									<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
									<input type="hidden" name="type" id="type" value="ModelsMyvindulaHowareu" />
								</div>
								<div metal:use-macro="context/myvindula-like-macro/macros/like" />
	
							</div>
							
			                <div class="comment-body">
			                    <p tal:replace="item/text|nothing" />
					  		</div>
							<!-- campos input necessario para a criação de comentariso -->
							<div id="comments" tal:condition="logado" >
								<div tal:attributes="id item/id|nothing">
									
									<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
									<input type="hidden" name="type" id="type" value="ModelsMyvindulaHowareu" />
								</div>
								<input type="button" value="Comentar" class="comments bt_comments" tal:attributes="id item/id|nothing" />
								<div id="new-comments"></div>
							</div>
						</div>
						<div class="comments-cont">
							<div metal:use-macro="context/myvindula-comments-macro/macros/comments" />
						</div>
					</tal:rep>	
		        </tal:def>
			</div>
			
			<div id="perfil" class="userpage"> <!-- display-none"--> 
				<!-- start: Others Information -->
				<!-- Contact -->
				<div id="grupo" tal:condition="view/valida_contato|nothing">
					<div class="area"><span>Contato</span></div>
					<img class="type-info" tal:attributes="src string:${view/static}/images/user_contact.png" />
					<table>
						<tr tal:condition="configuracao/email|nothing">
							<td class="field">E-mail</td>
							<td class="value" tal:content="form_data/email|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/phone_number|nothing">
							<td class="field">Telefone</td>
							<td class="value" tal:content="form_data/phone_number|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/location|nothing">
							<td class="field">Localiza&ccedil;&atilde;o</td>
							<td class="value" tal:content="form_data/location|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/postal_address|nothing">
							<td class="field">Endere&ccedil;o</td>
							<td class="value" tal:content="form_data/postal_address|nothing"></td>
						</tr>
					</table>
				</div>
				
				<!-- Corporative -->
				<div id="grupo" tal:condition="view/valida_corporativo|nothing" >
					<div class="area"><span>Corporativo</span></div>
					<img class="type-info" tal:attributes="src string:${view/static}/images/user_business.png" />
					<table>
						<tr tal:condition="configuracao/enterprise|nothing">
							<td class="field">Empresa</td>
							<td class="value" tal:content="form_data/enterprise|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/registration|nothing">
							<td class="field">Registro</td>
							<td class="value" tal:content="form_data/registration|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/position|nothing">
							<td class="field">Cargo</td>
							<td class="value" tal:content="form_data/position|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/admission_date|nothing">
							<td class="field">Data de Admiss&atilde;o</td>
							<td class="value" tal:condition="form_data/admission_date|nothing"  
											  tal:content="python:form_data.admission_date.strftime('%d/%m/%Y')"></td>
							<td class="value" tal:condition="not: form_data/admission_date|nothing"></td>  
						</tr>
						<tr tal:condition="configuracao/cost_center|nothing">
							<td class="field">Centro de custo</td>
							<td class="value" tal:content="form_data/cost_center|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/profit_centre|nothing">
							<td class="field">Centro de lucro</td>
							<td class="value" tal:content="form_data/profit_centre|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/special_roles|nothing">
							<td class="field">Funções Especiais</td>
							<td class="value" tal:content="form_data/special_roles|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/organisational_unit|nothing">
							<td class="field">Unidade organizacional</td>
							<td class="value" tal:content="form_data/organisational_unit|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/delegations|nothing">
							<td class="field">Delega&ccedil;&otilde;es</td>
							<td class="value" tal:content="form_data/delegations|nothing"></td>
						</tr>	
						<tr tal:condition="configuracao/reports_to|nothing">
							<td class="field">Reporta-se a</td>
							<td class="value" tal:content="form_data/reports_to|nothing"></td>
						</tr>
					</table>
				</div>	
				
				<!-- Others -->
				<div id="grupo" tal:condition="view/valida_others|nothing">
					<div  class="area"><span>Outras Informa&ccedil;&otilde;es</span></div>
					<img class="type-info" tal:attributes="src string:${view/static}/images/user_others.png" />
					<table>
						<tr tal:condition="configuracao/committess|nothing">
							<td class="field">Comissão</td>
							<td class="value" tal:content="form_data/committess|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/projetcs|nothing">
							<td class="field">Projetos</td>
							<td class="value" tal:content="form_data/projetcs|nothing"></td>
						</tr>			
						<tr tal:condition="configuracao/personal_information|nothing">
							<td class="field">Informa&ccedil;&atilde;o pessoal</td>
							<td class="value" tal:content="form_data/personal_information|nothing"></td>
						</tr>
						<tr tal:condition="configuracao/skills_expertise|nothing">
							<td class="field">Habilidades</td>
							<td class="value"><!-- tal:content="form_data/skills_expertise|nothing"-->
								<tal:def define="cursos python: view.get_Courses(user)">
									<tal:cont condition="cursos">
						        		<tal:rep repeat="curso cursos">
						        			<span tal:content="python:view.getCouses_byID(curso.vin_myvindula_courses_id).title">Departamento</span> <br />
						        		</tal:rep>
									</tal:cont>
					        	</tal:def>
							</td>
						</tr>					
						<tr tal:condition="configuracao/languages|nothing" >
							<td class="field">Idiomas</td>
							<td class="value"><!--tal:content="form_data/languages|nothing"-->
								<tal:def define="languages python: view.get_Languages(user)">
									<tal:cont condition="languages">
						        		<tal:rep repeat="language languages">
						        			<span tal:content="python:view.getLanguages_byID(language.vin_myvindula_languages_id).title">Departamento</span> <br />
						        		</tal:rep>
									</tal:cont>
					        	</tal:def>
							</td>
						</tr>		
						<tr tal:condition="configuracao/availability|nothing" >
							<td class="field">Disponibilidade</td>
							<td class="value" tal:content="form_data/availability|nothing"></td>
						</tr>				
						<tr tal:condition="configuracao/papers_published|nothing">
							<td class="field">Artigos publicados</td>
							<td class="value" tal:content="form_data/papers_published|nothing"></td>
						</tr>	
						<tr tal:condition="configuracao/teaching_research|nothing">
							<td class="field">Teaching Research</td>
							<td class="value" tal:content="form_data/teaching_research|nothing"></td>
						</tr>					
						<tr tal:condition="configuracao/resume|nothing">
							<td class="field">Resumo</td>
							<td class="value" tal:content="form_data/resume|nothing"></td>
						</tr>	
						<tr tal:condition="configuracao/blogs|nothing">
							<td class="field">Blogs</td>
							<td class="value" tal:content="form_data/blogs|nothing"></td>
						</tr>				
						<tr tal:condition="configuracao/customised_message|nothing">
							<td class="field">Mensagem personalizada</td>
							<td class="value" tal:content="form_data/customised_message|nothing"></td>
						</tr>
					</table>
				</div>
				<!-- end: Others Information -->
			</div>
		
			
			
			<!-- start: Scraps -->
			<div id="scraps" class="userpage geral_lista_comentarios" tal:condition="view/check_recados">
				
				<!-- Scraps Input -->
				<div id="comment-geral" tal:condition="logado">
					<h2 class="h2title" tal:content="string:Deixe um recado para ${form_data/name|nothing}:"></h2>
					<form action="" method="post" enctype="multipart/form-data" name="save-recados" tal:attributes="action string:${context/absolute_url}/myvindulalistuser?user=${user}&scraps=true">	
						
						<input type="hidden" name="destination" value="" tal:attributes="value user">	
						<input type="hidden" name="username" value="" tal:attributes="value context/@@plone_portal_state/member|nothing">
						<textarea  style="width: 100%; height: 81px;" name="text"></textarea>
		
						<div class="bt_comentar">
							<input type="hidden" name="form.submitted:boolean" value="True" />
							<input type="submit" name="submit" value="Publicar" id="save-recados" />
						</div>
					</form>
				</div>
				
				<!-- Scraps List -->
    			<tal:def define="items python:view.get_recados(user);">
					<div class="userpage geral_lista_comentarios" tal:condition="items">
						<h2 class="h2title">Outros recados!</h2>
						<tal:rep tal:repeat="item items">
							<div class="comment item_lista" tal:define="user item/username|nothing;
																		form_data python:view.get_prefs_user(user) or {};"> 
								<div class="commentImage">
									<a tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${user}">
					                    <img src="defaultUser.png" border="0" height="30"
						             		 tal:attributes="src python:view.getPhoto(user);
									 						 alt form_data/name|nothing;
															 title form_data/name|nothing;" />
									</a>
				                </div>
								<div class="documentByLine name-user">
									<h4><a tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${user}">
											<span tal:replace="form_data/name|nothing" /> | 
					                    	<span tal:replace="python:item.date_creation.strftime('%d/%m/%Y  %H:%M')" />
										</a></h4>
				                </div>
								<div id="like" tal:condition="logado">
									<div tal:attributes="id item/id|nothing">
										<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
										<input type="hidden" name="type" id="type" value="ModelsMyvindulaRecados" />
									</div>
									<div metal:use-macro="context/myvindula-like-macro/macros/like" />
								</div>
				                <div class="comment-body">
				                    <p tal:replace="item/text|nothing" />
						  		</div>
								<!-- campos input necessario para a criação de comentariso -->
								<div id="comments" tal:condition="logado" >
									<div tal:attributes="id item/id|nothing">
										<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
										<input type="hidden" name="type" id="type" value="ModelsMyvindulaRecados" />
									</div>
									<input type="button" value="Comentar" class="comments bt_comments" tal:attributes="id item/id|nothing" />
									<div id="new-comments"></div>
								</div>
							</div>
							<div class="comments-cont">
								<div metal:use-macro="context/myvindula-comments-macro/macros/comments" />
							</div>
						</tal:rep>	
					</div>
				</tal:def>
			</div>
			<!-- end: Scraps -->
			
		</div>
    </div>    
</body>
</html>











