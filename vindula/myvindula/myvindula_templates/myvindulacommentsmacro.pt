<metal:macro define-macro="comments">
	<tal:def define="view_comments python:context.restrictedTraverse('@@myvindula-comments')">
		<div class="comments-cont" tal:define="comments python:view_comments.get_comments(item.id, item._name_class);
												AnonymousUser context/portal_membership/isAnonymousUser|python:True;"
								   tal:condition="python: comments.count() > 0">
								  
			<tal:rep repeat="item comments">
				<div class="comment item_lista" tal:define="user_comment python: view_comments.get_prefs_user(item.username);
															user item/username|nothing"
												tal:condition="user_comment">
					<div class="commentImage">
		                <img src="defaultUser.png"
		             		 alt="" border="0"
		             		 height="30"
		             		 tal:attributes="src string: ${context/portal_url|nothing}/user-image?username=${item/username|nothing};
					 						 alt user_comment/name|nothing;
											 title user_comment/name|nothing;" />
		            </div>
					<div class="documentByLine name-user">
						<h4><a href="" tal:attributes="href string:${here/portal_url}/myvindulalistuser?user=${item/username|nothing}">
								<span tal:replace="user_comment/name|item/username" /> |	 
		                    	<span tal:condition="item/date_creation|nothing"  
									  tal:replace="python:item.date_creation.strftime('%d/%m/%Y  %H:%M')" />
							</a>
						</h4>
		            </div>
					<div id="like" tal:condition="python: not AnonymousUser">
						<div tal:attributes="id item/id|nothing">
							<input type="hidden" name="isPlone:boolean" id="isPlone" value="False" />
							<input type="hidden" name="type" id="type" value="ModelsMyvindulaComments" />
						</div>
						<div metal:use-macro="context/myvindula-like-macro/macros/like"> </div>
						
					</div>
		            <div class="comment-body">
		                <p tal:replace="item/text|nothing" />
			  		</div>
			  		<form action="#" method="post" enctype="multipart/form-data" style="text-align: right;"
					  		tal:condition="python: 'Manager' in member.getRoles() or str(member.getUserName()) == str(user)"
					        tal:attributes="action string:${context/absolute_url}/myvindula-comments">
							<input type="hidden" name="form.excluir:boolean" value="True" />

							<input type="hidden" name="url_context" id="url_comments" value="">
							<script>  type="text/javascript">
								$j('input[id="url_comments"]').attr('value',location);
							</script>
							<input type="hidden" name="id_comments" id="id_comments" tal:attributes="value item/id|nothing" />
							<input type="submit" name="excluir" id="excluir" value="Excluir" 
												 class="comments bt_comments" tal:attributes="id item/id|nothing" />	
					</form>
				</div>
			</tal:rep>
		</div>
	</tal:def>
</metal:macro>								